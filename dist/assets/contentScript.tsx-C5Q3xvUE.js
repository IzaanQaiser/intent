import{j as t,r as a,c as Te,R as Be}from"./client-DMp2t5-j.js";import{s as _}from"./supabaseClient-DihBYOwf.js";const be=10;function Ae({isVisible:r,isLoading:c,metrics:u,watchCostMinutes:d,readGainMinutes:m,readScoreGain:S,watchScorePenalty:M,summary:h,isClaimingRewards:E,hasClaimedRewards:ae,claimSecondsRemaining:k,claimCountdownLabel:K,quote:$,isAuthenticated:v,authError:Z,authInProgress:z,onLogin:q,onReadFirst:ee,onWatchNow:U,onClaimRewards:J}){var pe;if(!r)return null;if(v&&!u)return t.jsx("div",{className:"intent-overlay",children:t.jsxs("div",{className:"intent-overlay__panel",children:[t.jsx("div",{className:"intent-overlay__title",children:"Read First"}),t.jsx("div",{className:"intent-overlay__subtitle",children:$}),t.jsx("div",{className:"intent-overlay__loading",children:"Syncing your watch balance…"})]})});const y=u??{readScore:0,watchBalanceMinutes:0},[l,I]=a.useState(0),[T,se]=a.useState(0),[te,ne]=a.useState({left:0,width:0}),[B,re]=a.useState(!1),O=a.useRef(null),L=a.useRef(null),W=a.useRef(!1),p=a.useRef(null),N=a.useRef(0),g=a.useRef(null),H=a.useRef(null),b=a.useRef(null),oe=5e3,j=120,le=140,ue=2e3,F=a.useCallback(()=>{L.current!==null&&(cancelAnimationFrame(L.current),L.current=null),p.current!==null&&(cancelAnimationFrame(p.current),p.current=null),O.current=null,W.current=!1;const f=N.current;if(f<=0){I(0);return}const C=performance.now(),G=D=>{const A=D-C,Y=Math.min(A/le,1),_e=f*(1-Y);if(I(_e),Y>=1){p.current=null;return}p.current=requestAnimationFrame(G)};p.current=requestAnimationFrame(G)},[]),P=a.useCallback(()=>{g.current!==null&&(window.clearTimeout(g.current),g.current=null),re(!1)},[]),e=a.useCallback(()=>{g.current!==null&&window.clearTimeout(g.current),g.current=window.setTimeout(()=>{re(!0)},ue)},[]),n=a.useCallback(()=>{const f=performance.now();O.current=f,W.current=!1,p.current!==null&&(cancelAnimationFrame(p.current),p.current=null),I(0);const C=G=>{if(O.current===null)return;const D=G-O.current;let A=0;if(D<=j)A=D/j*.1;else{const Y=D-j,_e=oe-j;A=.1+Math.min(Y/_e,1)*.9}if(I(A),A>=1&&!W.current){W.current=!0,U(),F(),P();return}L.current=requestAnimationFrame(C)};L.current=requestAnimationFrame(C)},[U,F,P]),s=a.useCallback(()=>{n(),e()},[n,e]),i=a.useCallback(()=>{F(),P()},[F,P]);a.useEffect(()=>{N.current=l},[l]),a.useEffect(()=>{r||F()},[r,F]),a.useEffect(()=>P,[P]),a.useLayoutEffect(()=>{if(!v)return;const f=()=>{const G=H.current,D=b.current;if(!G||!D)return;const A=G.getBoundingClientRect(),Y=D.getBoundingClientRect();se(A.width),ne({left:Math.max(0,Y.left-A.left),width:Y.width})};f();const C=new ResizeObserver(f);return H.current&&C.observe(H.current),b.current&&C.observe(b.current),window.addEventListener("resize",f),()=>{C.disconnect(),window.removeEventListener("resize",f)}},[v]);const o=Math.floor(y.readScore/400)+1,w=Math.floor((y.readScore+S)/400)+1,V=o*400,Q=Math.max(0,V-y.readScore),x=y.watchBalanceMinutes-d,X=y.readScore-M-(x<0?be:0),R=Math.floor(X/400)+1,de=w>o?"↑":"-",je=R<o?"↓":"-",me=f=>Number.isInteger(f)?String(f):f.toFixed(1),Re=x>=0?`${x} min`:`-${Math.abs(x)} min`,he=y.watchBalanceMinutes+m,fe=me(m),Me=`+${S} score, +${fe}m`,ve=k>0,Ee=ve?`Read for ${K} to claim rewards`:`Claim your reading rewards (${Me})`,ke=he>=0?`+${me(he)}m`:`-${me(Math.abs(he))}m`,ye=c?"Generating Summary...":`Read Instead (Watch Balance +${fe}m)`,Le=T*l,Ce=Math.max(0,Math.min(te.width,Le-te.left)),Ie=Math.max(0,Ce);return t.jsx("div",{className:"intent-overlay",children:t.jsxs("div",{className:"intent-overlay__panel",children:[t.jsxs("div",{className:`intent-overlay__content${B?" intent-overlay__content--dim":""}`,children:[t.jsx("div",{className:"intent-overlay__title",children:"Read First"}),t.jsx("div",{className:"intent-overlay__subtitle",children:$}),v?t.jsxs("div",{className:"intent-overlay__metrics",children:[t.jsxs("div",{className:"intent-overlay__metric",children:[t.jsx("span",{className:"intent-overlay__metric-label",children:"Level"}),t.jsx("span",{className:"intent-overlay__metric-value",children:o})]}),t.jsxs("div",{className:"intent-overlay__metric",children:[t.jsx("span",{className:"intent-overlay__metric-label",children:"Read Score"}),t.jsx("span",{className:"intent-overlay__metric-value",children:u.readScore})]}),t.jsxs("div",{className:"intent-overlay__metric",children:[t.jsx("span",{className:"intent-overlay__metric-label",children:"Watch Balance"}),t.jsxs("span",{className:"intent-overlay__metric-value",children:[y.watchBalanceMinutes," min"]})]})]}):t.jsxs("div",{className:"intent-overlay__auth",children:[t.jsx("div",{className:"intent-overlay__auth-title",children:"Sign in to continue"}),t.jsx("div",{className:"intent-overlay__auth-copy",children:"Your score and balance sync to your account. Sign in to proceed."}),t.jsx("button",{className:"intent-overlay__auth-button",type:"button",onClick:q,disabled:z,children:z?"Authenticating…":"Sign in with Google"})]}),v?h?t.jsxs("div",{className:"intent-overlay__summary",children:[t.jsxs("div",{className:"intent-overlay__summary-header",children:[t.jsx("div",{className:"intent-overlay__summary-title",children:h.title||"Read First Brief"}),t.jsxs("div",{className:"intent-overlay__summary-meta",children:[h.readingTimeMinutes," min read"]})]}),t.jsxs("div",{className:"intent-overlay__summary-body",children:[h.summary?t.jsx("div",{className:"intent-overlay__summary-text",children:h.summary}):null,(pe=h.keyPoints)!=null&&pe.length?t.jsx("ul",{className:"intent-overlay__summary-list",children:h.keyPoints.map((f,C)=>t.jsx("li",{children:f},`${C}-${f.slice(0,16)}`))}):null]}),t.jsx("button",{className:"intent-overlay__summary-claim",type:"button",onClick:J,disabled:E||ae||ve,children:ae?"Rewards claimed":E?"Claiming rewards...":Ee})]}):t.jsxs("div",{className:"intent-overlay__choice",children:[t.jsx("div",{className:"intent-overlay__choice-title",children:"Your Choice"}),t.jsxs("div",{className:"intent-overlay__choice-grid",children:[t.jsxs("div",{className:"intent-overlay__choice-card intent-overlay__choice-card--watch",children:[t.jsx("div",{className:"intent-overlay__choice-header",children:"Watch Now"}),t.jsxs("div",{className:"intent-overlay__choice-chips",children:[t.jsxs("span",{className:"intent-overlay__chip intent-overlay__chip--warn",children:["Score -",M]}),t.jsxs("span",{className:"intent-overlay__chip intent-overlay__chip--warn",children:["Watch Balance -",d,"m"]}),t.jsxs("span",{className:"intent-overlay__chip intent-overlay__chip--highlight",children:["New Watch Balance ",Re]}),t.jsxs("span",{className:"intent-overlay__chip",children:["Level ",R," ",je]})]}),x<0?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"intent-overlay__choice-subline",children:["Additional score penalty -",be," (attention debt)"]}),t.jsx("div",{className:"intent-overlay__choice-subline",children:"Level progress paused while negative"}),R<o?t.jsxs("div",{className:"intent-overlay__choice-warning",children:["⚠️ Risk: Level down to ",R]}):null]}):null]}),t.jsxs("div",{className:"intent-overlay__choice-card intent-overlay__choice-card--read",children:[t.jsx("div",{className:"intent-overlay__choice-header",children:"Read Instead"}),t.jsxs("div",{className:"intent-overlay__choice-chips",children:[t.jsxs("span",{className:"intent-overlay__chip",children:["Score +",S]}),t.jsxs("span",{className:"intent-overlay__chip",children:["Watch Balance +",fe,"m"]}),t.jsxs("span",{className:"intent-overlay__chip intent-overlay__chip--highlight",children:["New Watch Balance ",ke]}),t.jsxs("span",{className:"intent-overlay__chip",children:["Level ",w," ",de]})]}),t.jsxs("div",{className:"intent-overlay__choice-note intent-overlay__choice-note--progress",children:[t.jsxs("span",{className:"intent-overlay__choice-note-label",children:["Level ",o+1," in"]}),t.jsx("span",{className:"intent-overlay__choice-note-score",children:Q}),t.jsx("span",{className:"intent-overlay__choice-note-unit",children:"pts"})]})]})]})]}):null]}),v&&!h?t.jsxs("div",{className:"intent-overlay__actions",children:[t.jsxs("button",{className:"intent-overlay__secondary",type:"button",onPointerDown:s,onPointerUp:i,onPointerLeave:i,onPointerCancel:i,ref:H,children:[t.jsx("span",{className:"intent-overlay__hold-fill",style:{transform:`scaleX(${l})`}}),t.jsxs("span",{className:"intent-overlay__button-label intent-overlay__button-label--progress",children:[t.jsxs("span",{ref:b,className:"intent-overlay__button-label-base",children:["Watch Now (Watch Balance -",d,"m)"]}),t.jsxs("span",{className:"intent-overlay__button-label-fill",style:{"--label-fill-px":`${Ie}px`},children:["Watch Now (Watch Balance -",d,"m)"]})]})]}),t.jsxs("button",{className:`intent-overlay__primary intent-overlay__primary--read${c?" intent-overlay__primary--read-active":""}`,type:"button",onClick:ee,disabled:c,children:[t.jsx("span",{className:"intent-overlay__press-fill"}),t.jsxs("span",{className:`intent-overlay__button-label intent-overlay__button-label--progress${c?" intent-overlay__button-label--loading":""}`,children:[t.jsx("span",{className:"intent-overlay__button-label-base",children:ye}),t.jsx("span",{className:"intent-overlay__button-label-fill",children:ye})]})]})]}):null,t.jsxs("div",{className:`intent-overlay__motto${B?" intent-overlay__motto--visible":""}`,children:[t.jsx("span",{className:"intent-overlay__motto-red",children:"Old ways"}),t.jsx("span",{className:"intent-overlay__motto-neutral",children:" dont open "}),t.jsx("span",{className:"intent-overlay__motto-green",children:"new doors"})]})]})})}const we="intent-read-first-root",ie="http://127.0.0.1:8787",Ne=40,$e=5,ce=10,Oe=10,We=200,Fe=15,Se=r=>Math.floor(r/400)+1,Pe=30;function ge(r){return r?r.trim().split(/\s+/).filter(Boolean).length:0}function De(r){var S;if(!r)return 0;const c=ge(r.summary),u=((S=r.keyPoints)==null?void 0:S.reduce((M,h)=>M+ge(h),0))??0,d=c+u;if(d===0)return 0;const m=Math.round(d/We*60);return Math.max(Fe,m)}function qe(r){const c=Math.floor(r/60),u=r%60;return c<=0?`${u}s`:`${c}:${String(u).padStart(2,"0")}`}function xe(r){try{const c=new URL(r);return c.pathname!=="/watch"?null:c.searchParams.get("v")}catch{return null}}function Ue(){var u;const r=document.querySelector("video");if(r&&!r.paused&&r.pause(),r){r.autoplay=!1;return}const c=document.querySelector(".ytp-play-button");c&&((u=c.getAttribute("aria-label"))!=null&&u.toLowerCase().includes("pause"))&&c.click()}function He(r){const c=Math.floor(r),u=Math.floor(c/3600),d=Math.floor(c%3600/60),m=c%60;return(u>0?[u,d,m]:[d,m]).map(M=>String(M).padStart(2,"0")).join(":")}function Ve(){var r,c;return((c=(r=document.querySelector("h1 yt-formatted-string"))==null?void 0:r.textContent)==null?void 0:c.trim())||document.title.replace(/\s+-\s+YouTube$/i,"").trim()||"Untitled video"}function Ge(){const r=document.querySelector("video");return!r||!Number.isFinite(r.duration)?null:r.duration}function Ye(r){return Number.isFinite(r)?Math.round(r*2/10)*10:Ne}function ze(r){if(!r||!Number.isFinite(r))return ce;const c=Math.max(0,r),u=Math.floor(c/60);return c%60>=Pe?u+1:u}function Je(){const[r,c]=a.useState(()=>xe(window.location.href));return a.useEffect(()=>{const u=()=>c(xe(window.location.href)),d=history.pushState,m=history.replaceState;history.pushState=function(...h){d.apply(this,h),u()},history.replaceState=function(...h){m.apply(this,h),u()},window.addEventListener("popstate",u);const S=new MutationObserver(u);S.observe(document.body,{childList:!0,subtree:!0});const M=window.setInterval(u,1e3);return()=>{history.pushState=d,history.replaceState=m,window.removeEventListener("popstate",u),S.disconnect(),window.clearInterval(M)}},[]),r}function Qe(){const r=Je(),[c,u]=a.useState(!0),[d,m]=a.useState(!1),[S,M]=a.useState(0),[h,E]=a.useState(null),[ae,k]=a.useState(!1),[K,$]=a.useState(null),[v,Z]=a.useState(null),[z,q]=a.useState(!1),[ee,U]=a.useState(!1),[J,y]=a.useState(0),[l,I]=a.useState(null),[T,se]=a.useState(ce),te=a.useRef(r),ne=a.useRef(null),B=a.useRef(null),re=a.useRef(async()=>!1),O=a.useMemo(()=>T/2,[T]),L=a.useMemo(()=>Ye(T),[T]),W=L,p=a.useMemo(()=>["It is not enough to be busy; so are the ants. The question is: What are we busy about? — Henry David Thoreau","The successful warrior is the average man, with laser-like focus. — Bruce Lee","Concentrate all your thoughts upon the work in hand. — Alexander Graham Bell","Simplicity is the ultimate sophistication. — Leonardo da Vinci","A well-spent day brings happy sleep. — Leonardo da Vinci","Your focus determines your reality. — George Lucas"],[]),N=a.useCallback(async(e,n)=>new Promise(s=>{var i;if(!((i=chrome==null?void 0:chrome.runtime)!=null&&i.sendMessage)){s({ok:!1,error:"Extension runtime unavailable."});return}try{chrome.runtime.sendMessage({type:"api_request",url:e,init:n},o=>{if(chrome.runtime.lastError){s({ok:!1,error:chrome.runtime.lastError.message});return}s(o)})}catch(o){s({ok:!1,error:o instanceof Error?o.message:String(o)})}}),[]),g=a.useCallback(async()=>{var w;if(!_)return{ok:!1,error:"Supabase client not configured."};const e=(w=l==null?void 0:l.user)==null?void 0:w.id;if(!e)return{ok:!1,error:"Supabase session unavailable."};const{data:n,error:s}=await _.from("user_state").select("user_id, read_score, watch_balance_minutes").eq("user_id",e).maybeSingle();if(s)return{ok:!1,error:s.message};if(n)return{ok:!0,data:n};const{data:i,error:o}=await _.from("user_state").insert({user_id:e,read_score:0,watch_balance_minutes:0}).select("user_id, read_score, watch_balance_minutes").single();return o||!i?{ok:!1,error:(o==null?void 0:o.message)||"Failed to create watch balance state."}:{ok:!0,data:i}},[l,_]),H=a.useCallback(async()=>{const e=await g();if(!e.ok)return{ok:!1,error:e.error};const n=e.data;return{ok:!0,data:{level:Se(n.read_score),readScore:n.read_score,watchBalanceMinutes:n.watch_balance_minutes}}},[g]);a.useEffect(()=>{r&&r!==te.current&&(te.current=r,u(!0),m(!1),se(ce),Z(null),U(!1),q(!1),y(0),B.current=null,ne.current=null)},[r]),a.useEffect(()=>{if(!v){y(0),B.current=null;return}const e=De(v),n=Date.now()+e*1e3;if(B.current=n,y(e),e===0)return;const s=window.setInterval(()=>{if(!B.current)return;const i=B.current-Date.now(),o=Math.max(0,Math.ceil(i/1e3));y(o),o<=0&&window.clearInterval(s)},500);return()=>window.clearInterval(s)},[v]),a.useEffect(()=>{if(!c||!r)return;let e=null;const n=()=>{const o=e?e.duration:null;se(ze(o))},s=()=>{const o=document.querySelector("video");if(!o){n();return}e&&e!==o&&(e.removeEventListener("loadedmetadata",n),e.removeEventListener("durationchange",n)),e=o,n(),e.addEventListener("loadedmetadata",n),e.addEventListener("durationchange",n)};s();const i=new MutationObserver(s);return i.observe(document.body,{childList:!0,subtree:!0}),()=>{i.disconnect(),e&&(e.removeEventListener("loadedmetadata",n),e.removeEventListener("durationchange",n))}},[c,r]);const b=a.useCallback(async()=>{if(!l)return!1;const e=await H();if(e.ok&&e.data)return $(e.data),!0;const n=await N(`${ie}/state`,{headers:{Authorization:`Bearer ${l.access_token}`}});if(!n.ok||!n.body)return!1;const s=n.body;return $({level:s.level,readScore:s.readScore,watchBalanceMinutes:s.watchBalanceMinutes}),!0},[l,H,N]);a.useEffect(()=>{re.current=b},[b]);const oe=a.useCallback(async(e,n)=>{var X;if(!_)return{ok:!1,error:"Supabase client not configured."};const s=(X=l==null?void 0:l.user)==null?void 0:X.id;if(!s)return{ok:!1,error:"Supabase session unavailable."};let i=0,o=0;switch(e){case"read_completed":i+=typeof(n==null?void 0:n.score)=="number"?n.score:Ne,o+=typeof(n==null?void 0:n.minutes)=="number"?n.minutes:$e;break;case"watch_initiated":{const R=typeof(n==null?void 0:n.minutes)=="number"?n.minutes:ce;o-=R;const de=typeof(n==null?void 0:n.score)=="number"?n.score:0;i-=de;break}case"session_end":{const R=await g();if(!R.ok||!R.data)return{ok:!1,error:R.error||"Unable to load state."};R.data.watch_balance_minutes<0&&(i-=Oe);break}default:return{ok:!0,data:null}}const w=await g();if(!w.ok||!w.data)return{ok:!1,error:w.error||"Unable to load state."};const V=w.data.read_score+i,Q=w.data.watch_balance_minutes+o,{error:x}=await _.from("user_state").update({read_score:V,watch_balance_minutes:Q,updated_at:new Date().toISOString()}).eq("user_id",s);return x?{ok:!1,error:x.message}:{ok:!0,data:{level:Se(V),readScore:V,watchBalanceMinutes:Q}}},[l,g,_]),j=a.useCallback(async(e,n)=>{if(!l)return null;const s=await oe(e,n);if(s.ok)return s.data??null;const i=await N(`${ie}/event`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.access_token}`},body:JSON.stringify({type:e,data:n})});return i.ok?i.body??null:null},[l,oe,N]);a.useEffect(()=>{if(!_)return;_.auth.getSession().then(({data:s})=>I(s.session));const{data:e}=_.auth.onAuthStateChange((s,i)=>{I(i),i&&k(!1)}),n=s=>{(s==null?void 0:s.type)==="auth_complete"&&(_.auth.getSession().then(({data:i})=>{I(i.session),i.session&&re.current()}),k(!1)),(s==null?void 0:s.type)==="auth_signed_out"&&(I(null),k(!1),u(!0),m(!1))};return chrome.runtime.onMessage.addListener(n),()=>{e.subscription.unsubscribe(),chrome.runtime.onMessage.removeListener(n)}},[_]),a.useEffect(()=>{l||($(null),Z(null),U(!1),q(!1),y(0),B.current=null)},[l]),a.useEffect(()=>{E(_?null:"Missing Supabase configuration.")},[]),a.useEffect(()=>{if(!r||!l)return;let e=0,n=null,s=!1;const i=async()=>{e+=1,!await b()&&!s&&e<3&&(n=window.setTimeout(i,1e3))};return i(),j("video_opened",{videoId:r}),()=>{s=!0,n!==null&&window.clearTimeout(n)}},[r,l,b,j]),a.useEffect(()=>{if(!r||!c||!l||!K||ne.current===r)return;ne.current=r,(async()=>{var s,i,o;const n=await N(`${ie}/transcript`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoId:r})});if(n.ok&&((s=n.body)!=null&&s.transcript)){const w=n.body.source?` (${n.body.source})`:"",V=`https://www.youtube.com/watch?v=${r}`,Q=((o=(i=document.querySelector("h1 yt-formatted-string"))==null?void 0:i.textContent)==null?void 0:o.trim())||document.title.replace(/\s+-\s+YouTube$/i,"").trim()||"Unknown",x=document.querySelector("video"),X=x&&Number.isFinite(x.duration)?He(x.duration):"Unknown";console.log(`[Intent]
URL: ${V}
LENGTH: ${X}
TITLE: ${Q}
TRANSCRIPT:${w}
${n.body.transcript}`)}else console.warn(`[Intent] Transcript unavailable for ${r}.`)})()},[r,c,l,K,N]),a.useEffect(()=>{c&&M(e=>(e+1)%p.length)},[c,p.length]),a.useEffect(()=>{if(!c)return;let e=null;const n=()=>{e==null||e.pause()},s=()=>{const o=document.querySelector("video");if(!o){Ue();return}e&&e!==o&&(e.removeEventListener("play",n),e.removeEventListener("playing",n)),e=o,e.autoplay=!1,e.addEventListener("play",n),e.addEventListener("playing",n),e.pause()};s();const i=new MutationObserver(s);return i.observe(document.body,{childList:!0,subtree:!0}),()=>{i.disconnect(),e&&(e.removeEventListener("play",n),e.removeEventListener("playing",n))}},[c,r]);const le=a.useCallback(async()=>{if(!l)return;u(!1),m(!1);const e=await j("watch_initiated",{minutes:T,videoId:r,score:W});e?$({level:e.level,readScore:e.readScore,watchBalanceMinutes:e.watchBalanceMinutes}):await b()},[j,r,l,b,T,W]),ue=a.useCallback(async()=>{var i;if(!l)return;m(!0),Z(null),U(!1),q(!1);const e=Ve(),n=Ge(),s=await N(`${ie}/summarize`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoId:r,title:e,durationSeconds:n})});s.ok&&((i=s.body)!=null&&i.summary)?Z(s.body):console.warn("[Intent] Summary unavailable",{videoId:r,status:s.status,error:s.error,body:s.body}),m(!1)},[r,l,N]),F=a.useCallback(async()=>{if(!l||!v||z||ee||J>0)return;q(!0);const e=await j("read_completed",{videoId:r,minutes:O,score:L});e?$({level:e.level,readScore:e.readScore,watchBalanceMinutes:e.watchBalanceMinutes}):await b(),U(!0),q(!1),window.location.assign("https://www.youtube.com/")},[l,v,z,ee,J,j,r,O,L,b]),P=a.useCallback(async()=>{var i;if(!_){E("Missing Supabase configuration.");return}k(!0);const e=(i=chrome.runtime)==null?void 0:i.getURL("auth.html"),{data:n,error:s}=await _.auth.signInWithOAuth({provider:"google",options:e?{redirectTo:e,skipBrowserRedirect:!0}:{skipBrowserRedirect:!0}});if(s||!(n!=null&&n.url)){E((s==null?void 0:s.message)||"Failed to start sign-in."),k(!1);return}try{chrome.runtime.sendMessage({type:"oauth_start",url:n.url},o=>{if(chrome.runtime.lastError){E(chrome.runtime.lastError.message),k(!1);return}o!=null&&o.ok||(E((o==null?void 0:o.error)||"OAuth failed."),k(!1))})}catch(o){E(o instanceof Error?o.message:"Extension runtime unavailable."),k(!1)}},[_]);return r?t.jsx(Ae,{isVisible:c,isLoading:d,isAuthenticated:!!l,authError:h,authInProgress:ae,metrics:K,watchCostMinutes:T,readGainMinutes:O,readScoreGain:L,watchScorePenalty:W,summary:v,isClaimingRewards:z,hasClaimedRewards:ee,claimSecondsRemaining:J,claimCountdownLabel:qe(J),quote:p[S],onLogin:P,onReadFirst:ue,onWatchNow:le,onClaimRewards:F}):null}function Xe(){if(document.getElementById(we))return;const r=document.createElement("div");r.id=we,document.body.appendChild(r),Te(r).render(t.jsx(Be.StrictMode,{children:t.jsx(Qe,{})}))}Xe();
